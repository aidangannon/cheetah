id,statement
cmcw1zaxw0003p1qk1fo9ss8m,"-- Total decay cost avoided over the last 30 days
SELECT
  DATE(timestamp)          AS day,
  SUM(decay_rate)   AS cost_avoided
FROM data_points
WHERE id = 'cmcw1zaxw0003p1qk1fo9ss8m'
  AND timestamp >= CURRENT_DATE - INTERVAL '30' DAY
GROUP BY DATE(timestamp)
ORDER BY day;"
cmcw3crxh0001poqkt5ctjjb0,"-- Count of total notifications by type in June 2025
SELECT
  notification_type,
  COUNT(*) AS total_alerts
FROM data_points
WHERE id = 'cmcw3crxh0001poqkt5ctjjb0'
  AND DATE(timestamp) BETWEEN '2025-06-01' AND '2025-06-30'
GROUP BY notification_type;"
cmcw3etd80002poqk6era3ko9,"-- Total items flagged and average per day over last week
SELECT
  SUM(items_flagged)          AS total_flagged,
  AVG(items_flagged)::DECIMAL(10,2) AS avg_per_day
FROM data_points
WHERE id = 'cmcw3etd80002poqk6era3ko9'
  AND timestamp >= CURRENT_DATE - INTERVAL '7' DAY;"
cmcxgnpq10001wpqk36vpzseb,"-- Daily decay values for plotting
SELECT
  DATE(timestamp)        AS day,
  decay_value  AS amount
FROM data_points
WHERE id = 'cmcxgnpq10001wpqk36vpzseb'
  AND timestamp BETWEEN '2025-06-02' AND '2025-06-25'
ORDER BY day;"
cmcxhohny0001ykqk3fnzs1qy,"-- Daily counts of 'Need approval' notifications in June 2025
SELECT
  DATE(timestamp)        AS day,
  COUNT(*)          AS need_approval_count
FROM data_points
WHERE id = 'cmcxhohny0001ykqk3fnzs1qy'
  AND notification_category = 'Need approval'
  AND DATE(timestamp) BETWEEN '2025-06-02' AND '2025-06-25'
GROUP BY DATE(timestamp)
ORDER BY day;"
